package com.ocft.gateway.serviceArrange;

import com.alibaba.fastjson.JSONObject;
import com.ocft.gateway.web.dto.request.FlowStateLangRequest;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;

/**
 * @Auther: 梵高先生
 * @Date: 2020/1/14 11:24
 * @Description:
 */
@RunWith(SpringRunner.class)
@SpringBootTest(value = "GatewayApplication")
public class StateLangConverter {

    @Autowired
    private com.ocft.gateway.stateMachineBak.StateLangConverter converter;

    @Test
    public void test(){
        String json = "{\"nodes\":[{\"size\":\"80*80\",\"shape\":\"flow-circle\",\"color\":\"#FA8C16\",\"x\":648,\"y\":55,\"index\":0,\"label\":\"开始节点\",\"id\":\"0000000000\",\"type\":\"node\"},{\"system\":\"medsci\",\"size\":\"200*80\",\"shape\":\"flow-rect\",\"color\":\"#FA8C16\",\"stateType\":\"task\",\"x\":648,\"y\":174,\"index\":1,\"label\":\"调用medsci系统的\\n/top/weekTop接口\",\"id\":\"f08db3c479ccabfa400c2eaf0f47437f\",\"type\":\"node\",\"url\":\"/top/weekTop\"},{\"type\":\"node\",\"size\":\"200*80\",\"shape\":\"flow-rect\",\"color\":\"#FA8C16\",\"label\":\"根据文章ID查询文章详情的参数转换器\",\"x\":647.5,\"y\":321.99999999999994,\"id\":\"ad6be76b2027525e806fa80f6045dcea\",\"index\":3,\"stateType\":\"converter\",\"url\":\"/top/weekTop\"},{\"type\":\"node\",\"size\":\"200*80\",\"shape\":\"flow-rect\",\"color\":\"#FA8C16\",\"label\":\"调用medsci系统的\\n/portal-article/getArticleById接口\",\"x\":647,\"y\":455.99999999999994,\"id\":\"5334a5d650e4c7c5cab39fd070acf805\",\"index\":5,\"stateType\":\"task\",\"url\":\"/portal-article/getArticleById\",\"system\":\"medsci\"},{\"size\":\"80*80\",\"shape\":\"flow-circle\",\"color\":\"#67C23A\",\"x\":650,\"y\":598.5,\"index\":7,\"label\":\"结束节点\",\"id\":\"1111111111\",\"type\":\"node\"}],\"edges\":[{\"sourceAnchor\":2,\"targetAnchor\":0,\"index\":2,\"source\":\"0000000000\",\"id\":\"de6ee9ad\",\"target\":\"f08db3c479ccabfa400c2eaf0f47437f\"},{\"source\":\"f08db3c479ccabfa400c2eaf0f47437f\",\"sourceAnchor\":2,\"target\":\"ad6be76b2027525e806fa80f6045dcea\",\"targetAnchor\":0,\"id\":\"df15b71a\",\"index\":4},{\"source\":\"ad6be76b2027525e806fa80f6045dcea\",\"sourceAnchor\":2,\"target\":\"5334a5d650e4c7c5cab39fd070acf805\",\"targetAnchor\":0,\"id\":\"d974f922\",\"index\":6},{\"source\":\"5334a5d650e4c7c5cab39fd070acf805\",\"sourceAnchor\":2,\"target\":\"1111111111\",\"targetAnchor\":0,\"id\":\"74854341\",\"index\":8}],\"gatewayInterface\":{\"id\":\"c75d8e6eb173bb857fb176e8cced0425\",\"name\":\"获取本周最受关注的文章\",\"url\":\"/article/mostPopularArticle\",\"backonUrl\":\"[{\\\"system\\\":\\\"medsci\\\",\\\"backonUrl\\\":\\\"/top/weekTop\\\"},{\\\"system\\\":\\\"medsci\\\",\\\"backonUrl\\\":\\\"/portal-article/getArticleById\\\"},{\\\"system\\\":\\\"jvhe\\\",\\\"backonUrl\\\":\\\"/weather/uni\\\"},{\\\"system\\\":\\\"test\\\",\\\"backonUrl\\\":\\\"/weatherTest/getWeatherByName\\\"}]\",\"type\":\"COMPLICATE\",\"status\":true,\"invokeConfig\":\"{\\\"Comment\\\":\\\"获取本周最受关注的文章的状态机\\\",\\\"Name\\\":\\\"L2FydGljbGUvbW9zdFBvcHVsYXJBcnRpY2xlX3N0YXRl\\\",\\\"StartState\\\":\\\"L3RvcC93ZWVrVG9wX3Rhc2s\\\",\\\"States\\\":{\\\"L3RvcC93ZWVrVG9wX3Rhc2s\\\":{\\\"Catch\\\":[{\\\"Next\\\":\\\"Fail\\\",\\\"Exceptions\\\":[\\\"java.lang.Throwable\\\"]}],\\\"Input\\\":[{\\\"code\\\":\\\"$.[L3RvcC93ZWVrVG9wX3Rhc2s][code]\\\",\\\"success\\\":\\\"$.[L3RvcC93ZWVrVG9wX3Rhc2s][success]\\\",\\\"backOnUrl\\\":\\\"$.[L3RvcC93ZWVrVG9wX3Rhc2s][backOnUrl]\\\",\\\"requestData\\\":\\\"$.[L3RvcC93ZWVrVG9wX3Rhc2s][requestData]\\\"}],\\\"Next\\\":\\\"L3RvcC93ZWVrVG9wX2NvbnZlcnRlcg\\\",\\\"Output\\\":{\\\"L3RvcC93ZWVrVG9wX3Rhc2s_result\\\":\\\"$.#root\\\"},\\\"ServiceMethod\\\":\\\"invokeHandler\\\",\\\"ServiceName\\\":\\\"defaultInvokeOut\\\",\\\"Type\\\":\\\"ServiceTask\\\"},\\\"d3JxL3Rlc3RfY29udmVydGVy\\\":{\\\"Catch\\\":[{\\\"Next\\\":\\\"Fail\\\",\\\"Exceptions\\\":[\\\"java.lang.Throwable\\\"]}],\\\"Input\\\":[{\\\"current\\\":\\\"d3JxL3Rlc3RfY29udmVydGVy\\\",\\\"data\\\":\\\"$.[L3BvcnRhbC1hcnRpY2xlL2dldEFydGljbGVCeUlkX3Rhc2s_result].data\\\",\\\"context\\\":\\\"$.#root\\\"}],\\\"Next\\\":\\\"Succeed\\\",\\\"Output\\\":{\\\"d3JxL3Rlc3RfY29udmVydGVy_result\\\":\\\"$.#root\\\"},\\\"ServiceMethod\\\":\\\"convert\\\",\\\"ServiceName\\\":\\\"paramsConverter\\\",\\\"Type\\\":\\\"ServiceTask\\\"},\\\"L3dlYXRoZXJUZXN0L2dldFdlYXRoZXJCeU5hbWVfdGFzaw\\\":{\\\"Catch\\\":[{\\\"Next\\\":\\\"Fail\\\",\\\"Exceptions\\\":[\\\"java.lang.Throwable\\\"]}],\\\"Input\\\":[{\\\"code\\\":\\\"$.[L3dlYXRoZXJUZXN0L2dldFdlYXRoZXJCeU5hbWVfdGFzaw][code]\\\",\\\"success\\\":\\\"$.[L3dlYXRoZXJUZXN0L2dldFdlYXRoZXJCeU5hbWVfdGFzaw][success]\\\",\\\"backOnUrl\\\":\\\"$.[L3dlYXRoZXJUZXN0L2dldFdlYXRoZXJCeU5hbWVfdGFzaw][backOnUrl]\\\",\\\"requestData\\\":\\\"$.[L3dlYXRoZXJUZXN0L2dldFdlYXRoZXJCeU5hbWVfdGFzaw][requestData]\\\"}],\\\"Next\\\":\\\"L3BvcnRhbC1hcnRpY2xlL2dldEFydGljbGVCeUlkX3Rhc2s\\\",\\\"Output\\\":{\\\"L3dlYXRoZXJUZXN0L2dldFdlYXRoZXJCeU5hbWVfdGFzaw_result\\\":\\\"$.#root\\\"},\\\"ServiceMethod\\\":\\\"invokeHandler\\\",\\\"ServiceName\\\":\\\"defaultInvokeOut\\\",\\\"Type\\\":\\\"ServiceTask\\\"},\\\"L3RvcC93ZWVrVG9wX2NvbnZlcnRlcg\\\":{\\\"Catch\\\":[{\\\"Next\\\":\\\"Fail\\\",\\\"Exceptions\\\":[\\\"java.lang.Throwable\\\"]}],\\\"Input\\\":[{\\\"current\\\":\\\"L3RvcC93ZWVrVG9wX2NvbnZlcnRlcg\\\",\\\"data\\\":\\\"$.[L3RvcC93ZWVrVG9wX3Rhc2s_result].data\\\",\\\"context\\\":\\\"$.#root\\\"}],\\\"Next\\\":\\\"L3dlYXRoZXIvdW5pX3Rhc2s\\\",\\\"Output\\\":{\\\"L3RvcC93ZWVrVG9wX2NvbnZlcnRlcg_result\\\":\\\"$.#root\\\"},\\\"ServiceMethod\\\":\\\"convert\\\",\\\"ServiceName\\\":\\\"paramsConverter\\\",\\\"Type\\\":\\\"ServiceTask\\\"},\\\"L3dlYXRoZXIvdW5pX3Rhc2s\\\":{\\\"Catch\\\":[{\\\"Next\\\":\\\"Fail\\\",\\\"Exceptions\\\":[\\\"java.lang.Throwable\\\"]}],\\\"Input\\\":[{\\\"code\\\":\\\"$.[L3dlYXRoZXIvdW5pX3Rhc2s][code]\\\",\\\"success\\\":\\\"$.[L3dlYXRoZXIvdW5pX3Rhc2s][success]\\\",\\\"backOnUrl\\\":\\\"$.[L3dlYXRoZXIvdW5pX3Rhc2s][backOnUrl]\\\",\\\"requestData\\\":\\\"$.[L3RvcC93ZWVrVG9wX2NvbnZlcnRlcg_result]\\\"}],\\\"Next\\\":\\\"L3dlYXRoZXJUZXN0L2dldFdlYXRoZXJCeU5hbWVfdGFzaw\\\",\\\"Output\\\":{\\\"L3dlYXRoZXIvdW5pX3Rhc2s_result\\\":\\\"$.#root\\\"},\\\"ServiceMethod\\\":\\\"invokeHandler\\\",\\\"ServiceName\\\":\\\"defaultInvokeOut\\\",\\\"Type\\\":\\\"ServiceTask\\\"},\\\"L3BvcnRhbC1hcnRpY2xlL2dldEFydGljbGVCeUlkX3Rhc2s\\\":{\\\"Catch\\\":[{\\\"Next\\\":\\\"Fail\\\",\\\"Exceptions\\\":[\\\"java.lang.Throwable\\\"]}],\\\"Input\\\":[{\\\"code\\\":\\\"$.[L3BvcnRhbC1hcnRpY2xlL2dldEFydGljbGVCeUlkX3Rhc2s][code]\\\",\\\"success\\\":\\\"$.[L3BvcnRhbC1hcnRpY2xlL2dldEFydGljbGVCeUlkX3Rhc2s][success]\\\",\\\"backOnUrl\\\":\\\"$.[L3BvcnRhbC1hcnRpY2xlL2dldEFydGljbGVCeUlkX3Rhc2s][backOnUrl]\\\",\\\"requestData\\\":\\\"$.[d3JxL3Rlc3RfY29udmVydGVy_result]\\\"}],\\\"Output\\\":{\\\"L3BvcnRhbC1hcnRpY2xlL2dldEFydGljbGVCeUlkX3Rhc2s_result\\\":\\\"$.#root\\\"},\\\"ServiceMethod\\\":\\\"invokeHandler\\\",\\\"ServiceName\\\":\\\"defaultInvokeOut\\\",\\\"Type\\\":\\\"ServiceTask\\\"},\\\"Succeed\\\":{\\\"Type\\\":\\\"Succeed\\\"},\\\"Fail\\\":{\\\"ErrorCode\\\":\\\"40000000\\\",\\\"Message\\\":\\\"状态机执行失败\\\",\\\"Type\\\":\\\"Fail\\\"}},\\\"Version\\\":\\\"0.0.2\\\"}\",\"flowConfig\":\"{\\\"nodes\\\":[{\\\"size\\\":\\\"80*80\\\",\\\"shape\\\":\\\"flow-circle\\\",\\\"color\\\":\\\"#FA8C16\\\",\\\"x\\\":648,\\\"y\\\":55,\\\"index\\\":0,\\\"label\\\":\\\"开始节点\\\",\\\"id\\\":\\\"0000000000\\\",\\\"type\\\":\\\"node\\\"},{\\\"system\\\":\\\"medsci\\\",\\\"size\\\":\\\"200*80\\\",\\\"shape\\\":\\\"flow-rect\\\",\\\"color\\\":\\\"#FA8C16\\\",\\\"stateType\\\":\\\"task\\\",\\\"x\\\":648,\\\"y\\\":174,\\\"index\\\":1,\\\"label\\\":\\\"调用medsci系统的\\\\n/top/weekTop接口\\\",\\\"id\\\":\\\"f08db3c479ccabfa400c2eaf0f47437f\\\",\\\"type\\\":\\\"node\\\",\\\"url\\\":\\\"/top/weekTop\\\"},{\\\"size\\\":\\\"200*80\\\",\\\"shape\\\":\\\"flow-rect\\\",\\\"color\\\":\\\"#FA8C16\\\",\\\"stateType\\\":\\\"converter\\\",\\\"x\\\":648.5,\\\"y\\\":310,\\\"index\\\":2,\\\"label\\\":\\\"根据文章ID查询文章详情的参数转换器\\\",\\\"id\\\":\\\"ad6be76b2027525e806fa80f6045dcea\\\",\\\"type\\\":\\\"node\\\"},{\\\"system\\\":\\\"medsci\\\",\\\"size\\\":\\\"200*80\\\",\\\"shape\\\":\\\"flow-rect\\\",\\\"color\\\":\\\"#FA8C16\\\",\\\"stateType\\\":\\\"task\\\",\\\"x\\\":649,\\\"y\\\":444,\\\"index\\\":3,\\\"label\\\":\\\"调用medsci系统的\\\\n/portal-article/getArticleById接口\\\",\\\"id\\\":\\\"5334a5d650e4c7c5cab39fd070acf805\\\",\\\"type\\\":\\\"node\\\",\\\"url\\\":\\\"/portal-article/getArticleById\\\"},{\\\"system\\\":\\\"jvhe\\\",\\\"size\\\":\\\"200*80\\\",\\\"shape\\\":\\\"flow-rect\\\",\\\"color\\\":\\\"#FA8C16\\\",\\\"stateType\\\":\\\"task\\\",\\\"x\\\":1029,\\\"y\\\":309.5,\\\"index\\\":7,\\\"label\\\":\\\"调用jvhe系统的\\\\n/weather/uni接口\\\",\\\"id\\\":\\\"8f72f7e91c713fc4b9d22c31ace7b71b\\\",\\\"type\\\":\\\"node\\\",\\\"url\\\":\\\"/weather/uni\\\"},{\\\"system\\\":\\\"test\\\",\\\"size\\\":\\\"200*80\\\",\\\"shape\\\":\\\"flow-rect\\\",\\\"color\\\":\\\"#FA8C16\\\",\\\"stateType\\\":\\\"task\\\",\\\"x\\\":1029.5,\\\"y\\\":444.5,\\\"index\\\":9,\\\"label\\\":\\\"调用test系统的\\\\n/weatherTest/getWeatherByName接口\\\",\\\"id\\\":\\\"c3b12b28fd8cece3ad1c5ecb8c65dde6\\\",\\\"type\\\":\\\"node\\\",\\\"url\\\":\\\"/weatherTest/getWeatherByName\\\"},{\\\"size\\\":\\\"200*80\\\",\\\"shape\\\":\\\"flow-rect\\\",\\\"color\\\":\\\"#FA8C16\\\",\\\"stateType\\\":\\\"converter\\\",\\\"x\\\":649.5,\\\"y\\\":584.5,\\\"index\\\":13,\\\"label\\\":\\\"wrq\\\",\\\"id\\\":\\\"1a5ada0593c23b11525460cbf216c715\\\",\\\"type\\\":\\\"node\\\"},{\\\"size\\\":\\\"80*80\\\",\\\"shape\\\":\\\"flow-circle\\\",\\\"color\\\":\\\"#67C23A\\\",\\\"x\\\":649.5,\\\"y\\\":744.5,\\\"index\\\":14,\\\"label\\\":\\\"结束节点\\\",\\\"id\\\":\\\"1111111111\\\",\\\"type\\\":\\\"node\\\"}],\\\"edges\\\":[{\\\"sourceAnchor\\\":2,\\\"targetAnchor\\\":0,\\\"index\\\":4,\\\"source\\\":\\\"0000000000\\\",\\\"id\\\":\\\"de6ee9ad\\\",\\\"target\\\":\\\"f08db3c479ccabfa400c2eaf0f47437f\\\"},{\\\"sourceAnchor\\\":2,\\\"targetAnchor\\\":0,\\\"index\\\":5,\\\"source\\\":\\\"f08db3c479ccabfa400c2eaf0f47437f\\\",\\\"id\\\":\\\"6eb87a3b\\\",\\\"target\\\":\\\"ad6be76b2027525e806fa80f6045dcea\\\"},{\\\"sourceAnchor\\\":2,\\\"targetAnchor\\\":0,\\\"index\\\":6,\\\"source\\\":\\\"ad6be76b2027525e806fa80f6045dcea\\\",\\\"id\\\":\\\"91b423f8\\\",\\\"target\\\":\\\"5334a5d650e4c7c5cab39fd070acf805\\\"},{\\\"sourceAnchor\\\":1,\\\"targetAnchor\\\":3,\\\"index\\\":8,\\\"source\\\":\\\"ad6be76b2027525e806fa80f6045dcea\\\",\\\"id\\\":\\\"bd408f24\\\",\\\"target\\\":\\\"8f72f7e91c713fc4b9d22c31ace7b71b\\\"},{\\\"sourceAnchor\\\":2,\\\"targetAnchor\\\":0,\\\"index\\\":10,\\\"source\\\":\\\"8f72f7e91c713fc4b9d22c31ace7b71b\\\",\\\"id\\\":\\\"220d9435\\\",\\\"target\\\":\\\"c3b12b28fd8cece3ad1c5ecb8c65dde6\\\"},{\\\"sourceAnchor\\\":3,\\\"targetAnchor\\\":1,\\\"index\\\":11,\\\"source\\\":\\\"c3b12b28fd8cece3ad1c5ecb8c65dde6\\\",\\\"id\\\":\\\"4c8fd98e\\\",\\\"target\\\":\\\"5334a5d650e4c7c5cab39fd070acf805\\\"},{\\\"sourceAnchor\\\":2,\\\"targetAnchor\\\":0,\\\"index\\\":12,\\\"source\\\":\\\"5334a5d650e4c7c5cab39fd070acf805\\\",\\\"id\\\":\\\"1868acb0\\\",\\\"target\\\":\\\"1a5ada0593c23b11525460cbf216c715\\\"},{\\\"sourceAnchor\\\":2,\\\"targetAnchor\\\":0,\\\"index\\\":15,\\\"source\\\":\\\"1a5ada0593c23b11525460cbf216c715\\\",\\\"id\\\":\\\"e3029dfd\\\",\\\"target\\\":\\\"1111111111\\\"}]}\",\"createTime\":\"2019-12-24\",\"updateTime\":\"2019-12-26\"}}";
        FlowStateLangRequest req = JSONObject.parseObject(json, FlowStateLangRequest.class);
        String convert = converter.convert(req);
        System.out.println(convert);
    }
}
